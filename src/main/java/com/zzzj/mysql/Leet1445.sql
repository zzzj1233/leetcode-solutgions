# Sales 表:
# +------------+------------+-------------+
# | sale_date  | fruit      | sold_num    |
# +------------+------------+-------------+
# | 2020-05-01 | apples     | 10          |
# | 2020-05-01 | oranges    | 8           |
# | 2020-05-02 | apples     | 15          |
# | 2020-05-02 | oranges    | 15          |
# | 2020-05-03 | apples     | 20          |
# | 2020-05-03 | oranges    | 0           |
# | 2020-05-04 | apples     | 15          |
# | 2020-05-04 | oranges    | 16          |
# +------------+------------+-------------+
#
# Result 表:
# +------------+--------------+
# | sale_date  | diff         |
# +------------+--------------+
# | 2020-05-01 | 2            |
# | 2020-05-02 | 0            |
# | 2020-05-03 | 20           |
# | 2020-05-04 | -1           |
# +------------+--------------+

SELECT sale_date, SUM(if(fruit = 'apples', sold_num, -sold_num)) as diff
FROM Sales
GROUP BY sale_date